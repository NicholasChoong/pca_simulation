df0 = data.frame(
Year = df$Year,
Period = factor(df$Period),
logPower = log10(df$Power),
logSpan = log10(df$Span),
logLength = log10(df$Length),
logWeight = log10(df$Weight),
logSpeed = log10(df$Speed),
logRange = log10(df$Range))
df1 = df0[df$Year <= 45,]
df2 = df0[df$Year > 45,]
p1 = ggplot(df1, (aes(logLength))) +
geom_density()
print(p1)
p1 = ggplot(df1, (aes(logLength), colour=red)) +
p1 = ggplot(df1, (aes(logLength, colour=red))) +
geom_density()
print(p1)
p1 = ggplot(df1, (aes(logLength, logPower))) +
geom_density()
print(p1)
knitr::opts_chunk$set(echo = TRUE,
tidy = TRUE)
setwd("C:/Users/user/OneDrive - The University of Western Australia/Units/STAT3064/Labs/Lab1")
rm(list = ls())
if (!is.null(sessionInfo()$otherPkgs)) {
invisible(
lapply(paste0('package:', names(sessionInfo()$otherPkgs)),
detach, character.only=TRUE, unload=TRUE)
)
}
options(stringsAsFactors = FALSE)
df = read.csv('aircraft.csv')
head(df)
summary(df)
library(ggplot2)
p1 = ggplot(data = df, aes(x = Power)) +
geom_histogram(binwidth = 2000)
print(p1)
p2 = ggplot(data = df, aes(log10(x = Power))) +
geom_histogram(binwidth = 0.2)
print(p2)
p3 = ggplot(df, aes(Power)) +
geom_density()
print(p3)
p4 = ggplot(df, (aes(log10(Power)))) +
geom_density()
print(p4)
df2 = data.frame(
year = df$Year,
period = factor(df$Period),
logPower = log10(df$Power),
logSpan = log10(df$Span),
logLength = log10(df$Length),
logWeight = log10(df$Weight),
logSpeed = log10(df$Speed),
logRange = log10(df$Range))
df2
pairs(df2[, 3:8])
library( plot3D )
scatter3D (df2$logWeight, df2$logSpan, df2$logLength,
phi = 20, theta = 80,
col = NULL, NAcol = "white", breaks = NULL,
colkey = NULL, panel.first = NULL,
clim = NULL, clab = NULL,
bty = "b", CI = NULL, surf = NULL,
add = FALSE, plot = TRUE)
library( plot3D )
scatter3D (df2$logWeight, df2$logSpan, df2$logLength,
phi = 10, theta = 90,
col = NULL, NAcol = "white", breaks = NULL,
colkey = NULL, panel.first = NULL,
clim = NULL, clab = NULL,
bty = "b", CI = NULL, surf = NULL,
add = FALSE, plot = TRUE)
library(GGally)
ggparcoord( df2,
groupColumn = "period",
columns = 3:8,
alpha = 0.1,
scale = "globalminmax",
boxplot = TRUE ) +
theme( legend.position = "bottom")
xtabs(~period, data=df2)
library(dplyr)
print(distinct(filter(df2, period == 1),year)$year)
print(distinct(filter(df2, period == 2),year)$year)
print(distinct(filter(df2, period == 3),year)$year)
dfp1 = filter(df2, period == 1)
p1 = ggplot(data = dfp1, aes(logPower)) +
geom_histogram(binwidth = 0.05)
p2 = ggplot(dfp1, (aes(logPower))) +
geom_density()
print(p1)
print(p2)
library(ggplot2)
ggplot( df2, aes( logPower, group = period, colour = period ) ) +
geom_density( aes( fill = period ), alpha = 0.4 ) +
ggtitle("All data")
knitr::opts_chunk$set(echo = TRUE,
tidy = TRUE)
setwd("C:/Users/user/OneDrive - The University of Western Australia/Units/STAT3064/Labs/Lab1")
rm(list = ls())
if (!is.null(sessionInfo()$otherPkgs)) {
invisible(
lapply(paste0('package:', names(sessionInfo()$otherPkgs)),
detach, character.only=TRUE, unload=TRUE)
)
}
options(stringsAsFactors = FALSE)
df = read.csv('aircraft.csv')
head(df)
summary(df)
library(ggplot2)
p1 = ggplot(data = df, aes(x = Power)) +
geom_histogram(binwidth = 2000)
print(p1)
p2 = ggplot(data = df, aes(log10(x = Power))) +
geom_histogram(binwidth = 0.2)
print(p2)
p3 = ggplot(df, aes(Power)) +
geom_density()
print(p3)
p4 = ggplot(df, (aes(log10(Power)))) +
geom_density()
print(p4)
df2 = data.frame(
year = df$Year,
period = factor(df$Period),
logPower = log10(df$Power),
logSpan = log10(df$Span),
logLength = log10(df$Length),
logWeight = log10(df$Weight),
logSpeed = log10(df$Speed),
logRange = log10(df$Range))
df2
pairs(df2[, 3:8])
library( plot3D )
scatter3D (df2$logWeight, df2$logSpan, df2$logLength,
phi = 20, theta = 80,
col = NULL, NAcol = "white", breaks = NULL,
colkey = NULL, panel.first = NULL,
clim = NULL, clab = NULL,
bty = "b", CI = NULL, surf = NULL,
add = FALSE, plot = TRUE)
library( plot3D )
scatter3D (df2$logWeight, df2$logSpan, df2$logLength,
phi = 10, theta = 90,
col = NULL, NAcol = "white", breaks = NULL,
colkey = NULL, panel.first = NULL,
clim = NULL, clab = NULL,
bty = "b", CI = NULL, surf = NULL,
add = FALSE, plot = TRUE)
library(GGally)
ggparcoord( df2,
groupColumn = "period",
columns = 3:8,
alpha = 0.1,
scale = "globalminmax",
boxplot = TRUE ) +
theme( legend.position = "bottom")
xtabs(~period, data=df2)
library(dplyr)
print(distinct(filter(df2, period == 1),year)$year)
print(distinct(filter(df2, period == 2),year)$year)
print(distinct(filter(df2, period == 3),year)$year)
dfp1 = filter(df2, period == 1)
p1 = ggplot(data = dfp1, aes(logPower)) +
geom_histogram(binwidth = 0.05)
p2 = ggplot(dfp1, (aes(logPower))) +
geom_density()
print(p1)
print(p2)
library(ggplot2)
ggplot( df2, aes( logPower, group = period, colour = period ) ) +
geom_density( aes( fill = period ), alpha = 0.4 ) +
ggtitle("All data")
pairs(df2[, 3:8])
pairs(dfp1[, 3:8])
ggplot( df2, aes( logLength, logWeight ) ) +
geom_density_2d( ) +
geom_point( aes( colour = period ), alpha = 0.6 ) +
theme( legend.position = "bottom")
ggplot( df2, aes( logSpeed, logSpan ) ) +
geom_density_2d( ) +
geom_point( aes( colour = period ), alpha = 0.6 ) +
theme( legend.position = "bottom")
Sigma0 = matrix(c(
3.1386518, 0.38872659, 0.6178228, 1.7576847, 0.77433973, 0.7508789,
0.3887266, 1.21417949, 0.1941453, 0.4518920, 0.01236855, 0.2155466,
0.6178228, 0.19414529, 1.2437919, 0.5970320, 0.15151088, 0.2665018,
1.7576847, 0.45189196, 0.5970320, 1.7083497, 0.52685668, 0.7109476,
0.7743397, 0.01236855, 0.1515109, 0.5268567, 0.53406192, 0.2299193,
0.7508789, 0.21554658, 0.2665018, 0.7109476, 0.22991933, 0.6642375),
byrow = TRUE, nrow = 6 )
ev = eigen(Sigma0)
values = ev$values
values
vectors = ev$vectors
vectors
plot(x = seq(1:length(values)), y = values,type = "o", xlab = "index", ylab = "eigenvalues")
plot(x = seq(1:length(values)), y = values^2,type = "o", xlab = "index", ylab = "eigenvalues squared")
S0 = Sigma0
spectral1 = eigen(S0)
V1 = spectral1$vectors
lambda1 = spectral1$values
diaglambda1 = diag( lambda1 )
S1 = V1 %*% diaglambda1 %*% t( V1 )
# now try m=2
diaglambda2 = diag( lambda1 )^2
S2 = V1 %*% diaglambda2 %*% t( V1 )
S2
1/diag( lambda1 )
diaglambda3 =  diag(lambda1^(-1) )
S3 = V1 %*% diaglambda3 %*% t( V1 )
S3
ev3 = eigen(S3)
values3 = ev3$values
plot(x = seq(1:length(values3)), y = values3^2,type = "o", xlab = "index", ylab = "eigenvalues squared")
diaglambda4 = diag( lambda1 ^(-2/3))
S4 = V1 %*% diaglambda4 %*% t( V1 )
S4
ev4 = eigen(S4)
values4 = ev4$values
plot(x = seq(1:length(values4)), y = values4^2,type = "o", xlab = "index", ylab = "eigenvalues squared")
Sigma0 = matrix(c(
3.1386518, 0.38872659, 0.6178228, 1.7576847, 0.77433973, 0.7508789,
0.3887266, 1.21417949, 0.1941453, 0.4518920, 0.01236855, 0.2155466,
0.6178228, 0.19414529, 1.2437919, 0.5970320, 0.15151088, 0.2665018,
1.7576847, 0.45189196, 0.5970320, 1.7083497, 0.52685668, 0.7109476,
0.7743397, 0.01236855, 0.1515109, 0.5268567, 0.53406192, 0.2299193,
0.7508789, 0.21554658, 0.2665018, 0.7109476, 0.22991933, 0.6642375),
byrow = TRUE, nrow = 6 )
Nreps = 200 # number of replications
n = 100 # sample size
results = data.frame() # an object to store the results in
set.seed( 19501111 ) # make the process reproducible to assist with debugging if needed
for( ii in 1:Nreps ) {
Samp =  MASS::mvrnorm(n = n, mu = rep(0,6), Sigma = Sigma0 ) # generate sample
pca.XX = prcomp( Samp )
eigvals = pca.XX$sdev ^ 2 # prcomp gives us the standard deviations, so square them
cond = eigvals[1]/eigvals[6]
res.incr = data.frame( replication = ii, # So we can find problems
eig1 = eigvals[1], # We are constructing one row of a dataframe
eig2 = eigvals[2], # at a time so have to do this clunky bit
eig3 = eigvals[3],
eig4 = eigvals[4],
eig5 = eigvals[5],
eig6 = eigvals[6],
cond.number = cond # The condition number.
)
results = rbind( results, res.incr ) # add the new dataframe at the bottom of the old one
}
summary( results ) # see what we have got
# Some graphs to try to understand some relationships
ggplot( results, aes( eig1 ) ) + geom_density()
ggplot( results, aes( eig6 ) ) + geom_density()
ggplot( results, aes( eig1, eig6 ) ) + geom_point()
ggplot( results, aes( eig1, eig6 ) ) + geom_point() + geom_density_2d()
# Density of the condition number
ggplot( results, aes( cond.number ) ) + geom_density()
colMeans(results[2:7])
summary(results[2:7])
results[1,2:6]
ggplot( results, aes( eig1 ) ) + geom_density() +
geom_vline( xintercept = results$eig1[1], colour = "red" )
ggplot( results, aes( eig2 ) ) + geom_density()+
geom_vline( xintercept = results$eig2[1], colour = "red" )
ggplot( results, aes( eig3 ) ) + geom_density()+
geom_vline( xintercept = results$eig3[1], colour = "red" )
ggplot( results, aes( eig4 ) ) + geom_density()+
geom_vline( xintercept = results$eig4[1], colour = "red" )
ggplot( results, aes( eig5 ) ) + geom_density()+
geom_vline( xintercept = results$eig5[1], colour = "red" )
ggplot( results, aes( eig6 ) ) + geom_density()+
geom_vline( xintercept = results$eig6[1], colour = "red" )
df = read.csv('aircraft.csv')
df0 = data.frame(
Year = df$Year,
Period = factor(df$Period),
logPower = log10(df$Power),
logSpan = log10(df$Span),
logLength = log10(df$Length),
logWeight = log10(df$Weight),
logSpeed = log10(df$Speed),
logRange = log10(df$Range))
df1 = df0[df$Year <= 45,]
df2 = df0[df$Year > 45,]
p1 = ggplot(df1, (aes(logLength, logPower))) +
geom_density()
print(p1)
p1 = ggplot(df1, (aes(logLength))) +
geom_density()
print(p1)
plot1 = ggplot(df1, (aes(logLength))) +
geom_density()
plot2 = ggplot(df1, (aes(logPower ))) +
geom_density()
plot3 = ggplot(df2, (aes(logLength))) +
geom_density()
plot4 = ggplot(df2, (aes(logPower ))) +
geom_density()
ggplot(df1, (aes(logLength))) +
geom_density()
plot2 = ggplot(df1, (aes(logPower ))) +
geom_density()
plot3 = ggplot(df2, (aes(logLength))) +
geom_density()
plot4 = ggplot(df2, (aes(logPower ))) +
geom_density()
ggplot(df1, (aes(logLength))) +
geom_density()
ggplot(df1, (aes(logPower ))) +
geom_density()
ggplot(df2, (aes(logLength))) +
geom_density()
ggplot(df2, (aes(logPower ))) +
geom_density()
df1 = df0[df$Year <= 45,]
df2 = df0[df$Year > 45,]
df0 = within(df0, Period[Year<= 45] <- 1)
df0
df1 = df0[df$Year <= 45,]
df2 = df0[df$Year > 45,]
df0 = within(df0, Period[Year<= 45] <- 1)
df0 = within(df0, Period[Year> 45] <- 2)
df0
ggplot(df0, (aes(logLength,group = Period, colour = Period))) +
geom_density()
ggplot(df0, (aes(logPower,group = Period, colour = Period ))) +
geom_density()
ggplot( df0, aes( logPower, logWeight ) ) +
geom_density_2d( ) +
geom_point( aes( colour = period ), alpha = 0.6 ) +
theme( legend.position = "bottom")
ggplot( df0, aes( logPower, logWeight ) ) +
geom_density_2d( ) +
geom_point( aes( colour = Period ), alpha = 0.6 ) +
theme( legend.position = "bottom")
ggplot( df0, aes( logSpeed, logLength ) ) +
geom_density_2d( ) +
geom_point( aes( colour = Period ), alpha = 0.6 ) +
theme( legend.position = "bottom")
ggplot( df0, aes( logPower, logWeight ) ) +
geom_density_2d( ) +
geom_point( aes( colour = Period ), alpha = 0.6 ) +
theme( legend.position = "bottom")
ggplot( df0, aes( logSpeed, logLength ) ) +
geom_density_2d( ) +
geom_point( aes( colour = Period ), alpha = 0.6 ) +
theme( legend.position = "bottom")
knitr::opts_chunk$set(echo = TRUE,tidy = TRUE)
setwd("C:/Users/user/OneDrive - The University of Western Australia/Units/STAT3064/Labs/Lab2")
rm(list = ls())
if (!is.null(sessionInfo()$otherPkgs)) {
invisible(
lapply(paste0('package:', names(sessionInfo()$otherPkgs)),
detach, character.only=TRUE, unload=TRUE)
)
}
options(stringsAsFactors = FALSE)
df = read.csv('aircraft.csv')
aircraft = data.frame(
logPower = log10(df$Power),
logSpan = log10(df$Span),
logLength = log10(df$Length),
logWeight = log10(df$Weight),
logSpeed = log10(df$Speed),
logRange = log10(df$Range))
library(tidyverse)
pca = prcomp(aircraft)
eigval = (pca$sdev)^2
eigval
print(pca)
summary(pca)
str(pca)
cumsum(var_explained)
ggplot(pcadf, aes(PC2)) +
geom_density()
pca$x[,1]
library(ggplot2)
var_explained = pca$sdev^2 / sum(pca$sdev^2)
qplot(,var_explained) +
geom_line() +
xlab("Principal Component") +
ylab("Variance Explained") +
ggtitle("Scree Plot") +
ylim(0, 1)
qplot(,cumsum(var_explained)) +
geom_line() +
xlab("Principal Component") +
ylab("Variance Explained") +
ggtitle("Cumulative contribution to total variance") +
ylim(0, 1)
pcadf = data.frame(pca$x)
ggplot(pcadf, aes(PC1)) +
geom_density()
ggplot(pcadf, aes(PC2)) +
geom_density()
pcadf
ggplot(pcadf,aes(x=PC1,y=PC2))
ggplot(pcadf,aes(x=PC1,y=PC2)) + geom_point()
ggplot(pcadf,aes(x=PC1,y=PC2)) + geom_point(aes( df,colour = period ))
pcadf2 = pcadf
pcadf2$Period = df$Period
pcadf2
#ggplot(pcadf,aes(x=PC1,y=PC2)) + geom_point(aes( df,colour = period ))
pcadf2 = pcadf
pcadf2$Period = df$Period
pcadf2
ggplot(pcadf2,aes(x=PC1,y=PC2)) + geom_point(aes( colour = Period ))
pcadf2 = pcadf
pcadf2$Period = df$Period
ggplot(pcadf2,aes(x=PC1,y=PC2)) + geom_point(aes( colour = Period ))
pcadf2 = pcadf
pcadf2$Period = df$Period
ggplot(pcadf2,aes(x=PC1,y=PC2)) + geom_point(aes( colour = factor(Period) ))
pcadf2 = pcadf
pcadf2$Period = factor(df$Period)
ggplot(pcadf2,aes(x=PC1,y=PC2)) + geom_point(aes( colour = Period ))
biplot(pcdaf)
biplot(pcadf)
biplot(x= pcadf$PC1, y=pcadf$PC2)
biplot(x=pcadf$PC1, y=pcadf$PC2)
biplot(pcadf$PC1, pcadf$PC2)
biplot(pcadf,col = c("white", "blue"))
biplot(pca,col = c("white", "blue"))
biplot(pca,col = c("white", "blue"), xlim=c(0, .1))
biplot(pca,col = c("white", "blue"), xlim=c(0, .15))
biplot(pca,col = c("white", "blue"), xlim=c(0, .13))
biplot(pca,col = c("white", "blue"), xlim=c(0, .13),ylim=c(-0.0, 0.05))
biplot(pca,col = c("white", "blue"), xlim=c(0, .13),ylim=)
biplot(pca,col = c("white", "blue"), xlim=c(0, .13),ylim=c(-.05, .05))
biplot(pca,col = c("white", "blue"), xlim=c(0, .13),ylim=c(-.05, .05),main='PCA Results')
biplot(pca,col = c("white", "blue"), xlim=c(0, .13),ylim=c(-.05, .05))
pca2 = prcomp(aircraft,scale=TRUE)
var_explained2 = pca2$sdev^2 / sum(pca2$sdev^2)
qplot(,var_explained2) +
geom_line() +
xlab("Principal Component") +
ylab("Variance Explained") +
ggtitle("Scree Plot") +
ylim(0, 1)
ggplot(pcadf2, aes(PC1)) +
geom_density()
ggplot(pcadf2, aes(PC2)) +
geom_density()
pcadf3 = pcadf2
pcadf3$Period = factor(df$Period)
ggplot(pcadf3,aes(x=PC1,y=PC2)) + geom_point(aes( colour = Period ))
biplot(pca2,col = c("white", "blue"), xlim=c(0, .13),ylim=c(-.05, .05))
biplot(pca2,col = c("white", "blue"), xlim=c(0, .13),ylim=c(-.1, .1))
setwd("C:/Users/user/OneDrive - The University of Western Australia/Units/STAT3064/Labs/Assignment1")
df = read.csv('aircraft.csv')
rm(list = ls())
if (!is.null(sessionInfo()$otherPkgs)) {
invisible(
lapply(paste0('package:', names(sessionInfo()$otherPkgs)),
detach, character.only=TRUE, unload=TRUE)
)
}
options(stringsAsFactors = FALSE)
df = read.csv('aircraft.csv')
setwd("C:/Users/user/OneDrive - The University of Western Australia/Units/STAT3064/Labs/Assignment1")
df = read.csv('aircraft.csv')
ass2pop <- read.csv('ass2pop.csv', header=FALSE)
setwd("C:/Users/user/OneDrive - The University of Western Australia/Units/STAT3064/Labs/Assignment1")
df = read.csv('./aircraft.csv')
df = read.csv('aircraft.csv')
rm(list = ls())
if (!is.null(sessionInfo()$otherPkgs)) {
invisible(
lapply(paste0('package:', names(sessionInfo()$otherPkgs)),
detach, character.only=TRUE, unload=TRUE)
)
}
options(stringsAsFactors = FALSE)
df = read.csv('aircraft.csv')
setwd("C:/Users/user/OneDrive - The University of Western Australia/Units/STAT3064/Labs/Assignment1")
rm(list = ls())
if (!is.null(sessionInfo()$otherPkgs)) {
invisible(
lapply(paste0('package:', names(sessionInfo()$otherPkgs)),
detach, character.only=TRUE, unload=TRUE)
)
}
options(stringsAsFactors = FALSE)
df = read.csv('aircraft.csv')
df = read.csv('aircraft.csv')
df0 = data.frame(
Year = df$Year,
Period = factor(df$Period),
logPower = log10(df$Power),
logSpan = log10(df$Span),
logLength = log10(df$Length),
logWeight = log10(df$Weight),
logSpeed = log10(df$Speed),
logRange = log10(df$Range))
df0 = within(df0, Period[Year<= 45] <- 1)
df0 = within(df0, Period[Year> 45] <- 2)
df0
ggplot(df0, (aes(logLength,group = Period, colour = Period))) +
geom_density()
setwd("C:/Users/user/OneDrive - The University of Western Australia/Units/STAT3064/Labs/Assignment1")
rm(list = ls())
if (!is.null(sessionInfo()$otherPkgs)) {
invisible(
lapply(paste0('package:', names(sessionInfo()$otherPkgs)),
detach, character.only=TRUE, unload=TRUE)
)
}
options(stringsAsFactors = FALSE)
